<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UPnPlib: Socket module</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">UPnPlib<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">&#39;Universal Plug and Play plus&#39; System Developement Kit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Socket module<div class="ingroups"><a class="el" href="../../d4/d32/group__upnplib.html">* * object oriented UPnP library</a> &raquo; <a class="el" href="../../dd/df8/group__upnplib-Addressing.html">Step 0: Addressing</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>The socket module contains all classes and free functions to manage network sockets.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d84/classupnplib_1_1CSocket__basic.html">upnplib::CSocket_basic</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get information from a raw network socket file descriptor.  <a href="../../db/d84/classupnplib_1_1CSocket__basic.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d73/classupnplib_1_1CSocket.html">upnplib::CSocket</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage all aspects of a network socket.  <a href="../../d8/d73/classupnplib_1_1CSocket.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd8/classupnplib_1_1ISocketErr.html">upnplib::ISocketErr</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Portable catch <b>one</b> network socket error from the operating system, and provide information about it.  <a href="../../d9/dd8/classupnplib_1_1ISocketErr.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d16/classupnplib_1_1CSocketErrService.html">upnplib::CSocketErrService</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d5/d67/Glossary.html#glossary_depinj">di-service</a> for portable handling of network socket errors.  <a href="../../d1/d16/classupnplib_1_1CSocketErrService.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dd2/classupnplib_1_1CSocketErr.html">upnplib::CSocketErr</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d5/d67/Glossary.html#glossary_depinj">di-client</a> for portable handling of network socket errors with injected <a class="el" href="../../d5/d67/Glossary.html#glossary_depinj">di-service</a>.  <a href="../../d2/dd2/classupnplib_1_1CSocketErr.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaa9494d0f2750c611339d1336ae8183d8" id="r_gaa9494d0f2750c611339d1336ae8183d8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d86/group__upnplib-socket.html#gaa9494d0f2750c611339d1336ae8183d8">WINSOCK_INIT</a></td></tr>
<tr class="memdesc:gaa9494d0f2750c611339d1336ae8183d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize and cleanup Microsoft Windows Sockets.  <br /></td></tr>
<tr class="separator:gaa9494d0f2750c611339d1336ae8183d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga5738af1c9e42dc87957952b00e67f080" id="r_ga5738af1c9e42dc87957952b00e67f080"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d86/group__upnplib-socket.html#ga5738af1c9e42dc87957952b00e67f080">upnplib::PSocketErr</a> = std::shared_ptr&lt; <a class="el" href="../../d9/dd8/classupnplib_1_1ISocketErr.html">ISocketErr</a> &gt;</td></tr>
<tr class="memdesc:ga5738af1c9e42dc87957952b00e67f080"><td class="mdescLeft">&#160;</td><td class="mdescRight">Smart pointer to <a class="el" href="../../d5/d67/Glossary.html#glossary_depinj">di-service</a> objects that handle network socket errors and used to inject the objects.  <br /></td></tr>
<tr class="separator:ga5738af1c9e42dc87957952b00e67f080"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga99c7777de5a847f201f6d2f66540a535" id="r_ga99c7777de5a847f201f6d2f66540a535"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d86/group__upnplib-socket.html#ga99c7777de5a847f201f6d2f66540a535">upnplib::anonymous_namespace{socket.cpp}::getsockname</a> (<a class="el" href="../../da/dc0/UpnpInet_8hpp.html#a8dc8083897335125630f1af5dafd5831">SOCKET</a> a_sockfd, sockaddr *a_addr, socklen_t *a_addrlen)</td></tr>
<tr class="memdesc:ga99c7777de5a847f201f6d2f66540a535"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for the ::getsockname() system function.  <br /></td></tr>
<tr class="separator:ga99c7777de5a847f201f6d2f66540a535"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The socket module contains all classes and free functions to manage network sockets. </p>
<p>This module mainly consists of the CSocket class but also provides free functions to manage a socket. The problem is that socket handling isn't very good portable. There is different behavior on the supported platforms Unix, MacOS and Microsoft Windows. The CSocket class atempts to be consistent portable on all three platforms by using common behavior or by emulating missing functions on a platform.</p>
<h1><a class="anchor" id="autotoc_md12"></a>
Specification for CSocket</h1>
<p>The class encapsulates and manages one raw socket file descriptor. The file descriptor of a valid socket object cannot be changed but the object with its immutable file descriptor can be moved and assigned to another socket object. Copying a socket object isn't supported because having two objects with the same file descriptor may be very error prone in particular with multithreading. Effort has been taken to do not cache any socket information outside the socket file descriptor. All socket informations are direct set and get to/from the operating system with the file descriptor. The socket file descriptor is always valid except on an empty socket object.</p>
<p><a class="anchor" id="empty_socket"></a></p>
<h2><a class="anchor" id="autotoc_md13"></a>
empty socket object</h2>
<p>An empty socket object can be instantiated with the default constructor, e.g. <code>CSocket sockObj;</code>. It is a valid object and should be destructed. When moving a socket object, the left over source object is also empty. An empty socket object has an <code>INVALID_SOCKET</code> defined and no valid content. It throws an exception if using any of its Setter and Getter. Moving and assigning it is possible.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
address family</h2>
<p>Only address family <code>AF_INET6</code> and <code>AF_INET</code> is supported. Any other address family throws an exception.</p>
<h2><a class="anchor" id="autotoc_md15"></a>
socket type</h2>
<p>Only <code>SOCK_STREAM</code> and <code>SOCK_DGRAM</code> is supported. Any other type throws an exception.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
valid socket file descriptor</h2>
<p>I get this from the C standard library function: <code>int ::socket(address_family, socket_type, protocol)</code>. Other arguments than address family and socket type do not instantiate a valid socket object and throw an exception. For the protocol argument is always the default one used that is internal hard coded with argument 0.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
options SO_REUSEADDR and SO_EXCLUSIVEADDRUSE</h2>
<p>I don't set the option to immediately reuse an address and I always set the option <code>SO_EXCLUSIVEADDRUSE</code> on Microsoft Windows. For more details of this have a look at <a class="el" href="../../d2/d59/Overview.html#overview_reuseaddr">Socket option &quot;reuse address&quot;</a>. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gaa9494d0f2750c611339d1336ae8183d8" name="gaa9494d0f2750c611339d1336ae8183d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa9494d0f2750c611339d1336ae8183d8">&#9670;&#160;</a></span>WINSOCK_INIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WINSOCK_INIT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize and cleanup Microsoft Windows Sockets. </p>
<div class="fragment"><div class="line"><span class="comment">// Usage e.g.:</span></div>
<div class="line"><a class="code hl_define" href="../../db/d86/group__upnplib-socket.html#gaa9494d0f2750c611339d1336ae8183d8">WINSOCK_INIT</a></div>
<div class="line"><span class="comment">// Do Microsoft Windows socket stuff</span></div>
<div class="ttc" id="agroup__upnplib-socket_html_gaa9494d0f2750c611339d1336ae8183d8"><div class="ttname"><a href="../../db/d86/group__upnplib-socket.html#gaa9494d0f2750c611339d1336ae8183d8">WINSOCK_INIT</a></div><div class="ttdeci">#define WINSOCK_INIT</div><div class="ttdoc">Initialize and cleanup Microsoft Windows Sockets.</div><div class="ttdef"><b>Definition</b> <a href="../../da/dfc/socket_8hpp_source.html#l00461">socket.hpp:461</a></div></div>
</div><!-- fragment --><p>Winsock needs to be initialized before using it and it needs to be freed. I do that with a class, following the RAII paradigm. Multiple initialization doesn't matter. This is managed by the operating system with a counter. It ensures that winsock is initialzed only one time and freed with the last free call. To be portable this macro can be used on all platforms. It ensures that the Winsock initialization is only done on Microsoft Windows. </p>

<p class="definition">Definition at line <a class="el" href="../../da/dfc/socket_8hpp_source.html#l00461">461</a> of file <a class="el" href="../../da/dfc/socket_8hpp_source.html">socket.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga5738af1c9e42dc87957952b00e67f080" name="ga5738af1c9e42dc87957952b00e67f080"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5738af1c9e42dc87957952b00e67f080">&#9670;&#160;</a></span>PSocketErr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../db/d86/group__upnplib-socket.html#ga5738af1c9e42dc87957952b00e67f080">upnplib::PSocketErr</a> = typedef std::shared_ptr&lt;<a class="el" href="../../d9/dd8/classupnplib_1_1ISocketErr.html">ISocketErr</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Smart pointer to <a class="el" href="../../d5/d67/Glossary.html#glossary_depinj">di-service</a> objects that handle network socket errors and used to inject the objects. </p>

<p class="definition">Definition at line <a class="el" href="../../da/dfc/socket_8hpp_source.html#l00491">491</a> of file <a class="el" href="../../da/dfc/socket_8hpp_source.html">socket.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga99c7777de5a847f201f6d2f66540a535" name="ga99c7777de5a847f201f6d2f66540a535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga99c7777de5a847f201f6d2f66540a535">&#9670;&#160;</a></span>getsockname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int upnplib::anonymous_namespace{socket.cpp}::getsockname </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/dc0/UpnpInet_8hpp.html#a8dc8083897335125630f1af5dafd5831">SOCKET</a>&#160;</td>
          <td class="paramname"><em>a_sockfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">sockaddr *&#160;</td>
          <td class="paramname"><em>a_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">socklen_t *&#160;</td>
          <td class="paramname"><em>a_addrlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for the ::getsockname() system function. </p>
<p>The system function ::getsockname() behaves different on different platforms in particular with error handling on Microsoft Windows. This function provides a portable version. The calling options are the same as documented for the system function. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/d81/socket_8cpp_source.html#l00033">33</a> of file <a class="el" href="../../d8/d81/socket_8cpp_source.html">socket.cpp</a>.</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../db/d86/group__upnplib-socket_ga99c7777de5a847f201f6d2f66540a535_cgraph.png" border="0" usemap="#adb/d86/group__upnplib-socket_ga99c7777de5a847f201f6d2f66540a535_cgraph" alt=""/></div>
<map name="adb/d86/group__upnplib-socket_ga99c7777de5a847f201f6d2f66540a535_cgraph" id="adb/d86/group__upnplib-socket_ga99c7777de5a847f201f6d2f66540a535_cgraph">
<area shape="rect" title="Wrapper for the ::getsockname() system function." alt="" coords="5,29,199,84"/>
<area shape="poly" title=" " alt="" coords="64,29,64,19,71,10,84,5,102,3,124,6,136,14,134,18,122,11,102,8,85,10,74,15,69,21,69,29"/>
</map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../db/d86/group__upnplib-socket_ga99c7777de5a847f201f6d2f66540a535_icgraph.png" border="0" usemap="#adb/d86/group__upnplib-socket_ga99c7777de5a847f201f6d2f66540a535_icgraph" alt=""/></div>
<map name="adb/d86/group__upnplib-socket_ga99c7777de5a847f201f6d2f66540a535_icgraph" id="adb/d86/group__upnplib-socket_ga99c7777de5a847f201f6d2f66540a535_icgraph">
<area shape="rect" title="Wrapper for the ::getsockname() system function." alt="" coords="5,29,199,84"/>
<area shape="poly" title=" " alt="" coords="134,18,122,11,102,8,85,10,74,15,69,21,69,29,64,29,64,19,71,10,84,5,102,3,124,6,136,14"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
