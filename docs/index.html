<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UPnPlib: The UPnP Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">UPnPlib<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">&#39;Universal Plug and Play plus&#39; System Developement Kit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">The UPnP Library </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_README"></a><b>Under developement!</b> Not usable at time. README.md only as draft, work in progress.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
1. Overview</h1>
<p >This is a fork of the <a href="https://github.com/pupnp/">Portable SDK for UPnP Devices (pupnp)</a> with the aim of a complete re-engeneering. The following general goals are in progress or planned:</p><ul>
<li>Drop in compatibillity with the old pupnp library</li>
<li>Continue optimization for embedded devices</li>
<li>Based on C++ instead of C</li>
<li>Object oriented programming</li>
<li>Unit-Test driven developement</li>
<li>Using CMake for managing the code</li>
<li>Focus on IPv6 support</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
2. Version numbering</h1>
<p >We follow the <a href="https://semver.org/spec/v2.0.0.html#semantic-versioning-200">Semantic Versioning</a>.</p>
<p >The fork is based on <a href="https://github.com/pupnp/pupnp/releases/tag/release-1.14.18">release-1.14.18</a> from the pupnp library. Because it is intended to be backwards compatible on the API we start with release number 1.14.0 for this repository to reflect it by following</p><ul>
<li>MAJOR version when you make incompatible API changes,</li>
<li>MINOR version when you add functionality in a backwards compatible manner, and</li>
<li>PATCH version when you make backwards compatible bug fixes.</li>
</ul>
<p >Because we will use CMake to manage the code it can be seen as integral part of it. The version number will also include changes to the CMake system.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
3. Milestones</h1>
<ul>
<li>Ongoing: create extensive Unit Tests for IP4 without modification of the old source code</li>
<li>Ongoing: define C++ interfaces for the API</li>
<li>ToDo: change old C program to C++ objects but preserve drop in compatibility</li>
<li>ToDo: support IP6</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
4. Cmake subprojects</h1>
<p >UPnPlib | +------------&mdash;+---------&mdash;+----------&mdash;+-------------&mdash;+ | | | | | UPNPLIB_CORE UPNPLIB_IXML PUPNP UPNPLIB_GTESTS UPNPLIB_SAMPLE / \ PUPNP_UPNP PUPNP_IXML \ PUPNP_IXML_TEST</p>
<p >These names are also the names of the CMake subprojects.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
5. Build Instructions</h1>
<p >If nothing others said we are always staying at the root directory of the project (CMAKE_SOURCE_DIR), that is <b>upnplib/</b> if you don't changed the name.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
5.1. Linux build</h2>
<p >t.b.d. </p><pre class="fragment">upnplib$ cmake -S . -B build
upnplib$ cmake --build build
</pre><p> As noted by cmake to clean up a build you will have to delete all build directories on the main project and all subprojects. I do it with: </p><pre class="fragment">upnplib$ find -type d -name build -exec rm -rf {} \;
</pre> <h2><a class="anchor" id="autotoc_md7"></a>
5.2. Microsoft Windows Build</h2>
<p >The developement of this UPnP Library has started on Linux. So for historical reasons it uses POSIX threads (pthreads) as specified by <a href="http://get.posixcertified.ieee.org/certification_guide.html">The Open Group</a>. Unfortunately Microsoft Windows does not support it so we have to use a third party library. We use the well known and well supported <a href="https://sourceforge.net/p/pthreads4w">pthreads4w library</a>. To keep things simple for you I have copied the latest stable version archive to this project. It will be build with the installation of this project and should do out of the box. This archive will always be downloaded but deleted on other systems than MS Windows. To build the UPnPlib just do </p><pre class="fragment">upnplib$ cmake -S . -B build
upnplib$ cmake --build build --config Release
</pre><p> After build don't forget to copy the needed <code>./build/_deps/pthreads4w-build/pthread*.dll</code> library file to a location where your program can find it. Copying it to your programs directory or to the system directory <code>Windows\System32</code> will always do. Within the project developement directory tree (default root ./upnplib/) built programs and libraries find its dll files. There is nothing to do.</p>
<p >As noted by cmake to clean up a build you will have to delete the ./build/ directory on the main project.</p>
<p >If you need more details about installation of POSIX threads on Microsoft Windows I have made an example at <a href="https://github.com/upnplib/pthreadsWinLin.git">github pthreadsWinLin</a>.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
5.3 Googletest build</h2>
<p >I recommend to <a href="https://github.com/upnplib/upnplib/blob/main/gtests/README.md">use shared gtest libraries</a> for this project. But you can still build with default static gtest libraries if you prefer it. </p><pre class="fragment"># recommended shared libs
upnplib$ cmake -S . -B build -D UPNP_GOOGLETEST=ON -D BUILD_SHARED_LIBS=ON
# or alternative static libs
upnplib$ cmake -S . -B build -D UPNP_GOOGLETEST=ON
upnplib$ cmake --build build
</pre><p> Please note that option BUILD_SHARED_LIBS only effects Googletest. By default program type <b>Release</b> is build. The build type is cached so Googletest will build the last selected type. This may be confusing if you rebuild Googletest without deleting all build directories. So on rebuild you should always specify all wanted options, for example enable Googletest with static libraries on a previous build: </p><pre class="fragment"># On Linux
upnplib$ cmake -S . -B build -D CMAKE_BUILD_TYPE=Debug
upnplib$ cmake --build build
upnplib$ cmake -S . -B build -D UPNP_GOOGLETEST=ON -D BUILD_SHARED_LIBS=OFF -D CMAKE_BUILD_TYPE=Release
upnplib$ cmake --build build

# On MS Windows
# t.b.d.
# To find the dll files for the test executables add its directory to the path. For example on PowerShell I use:
PS&gt; $env:path_orig = $env:path
PS&gt; $env:Path += ';C:\Users\ingo\devel\upnplib\build\bin\Release'
PS&gt; .\build\gtests\Release\test_template.exe
</pre> <h1><a class="anchor" id="autotoc_md9"></a>
5. Security</h1>
<p >The following security issues are taken into account: </p>
<h2><a class="anchor" id="autotoc_md10"></a>
Reuse address</h2>
<p >For security and stability resons there is a delay when a server closes a network conection. By default it accepts a new connection on its same local interface address only after a TIME_WAIT. But many server want to be available immediately again on the network with the risk of network communication problems. They use a socket option that can be set to reuse the address, <a href="https://hea-www.harvard.edu/~fine/Tech/addrinuse.html">Bind: Address Already in Use</a>. This library prefers security and do not use this option. A TIME_WAIT is not necessary if the remote peer closes the connection. Upnplib uses the protocol to signal the remote peer to shutdown the connection if it support it. </p>
<h2><a class="anchor" id="autotoc_md11"></a>
Socket network security on Microsoft Windows</h2>
<p >In the past Windows had a very bad network security on low level socket handling as documented at <a href="https://learn.microsoft.com/en-us/windows/win32/winsock/using-so-reuseaddr-and-so-exclusiveaddruse">Using SO_REUSEADDR and SO_EXCLUSIVEADDRUSE</a>. Microsoft has fixed this since Windows Server 2003. The network stack now behaves like it does by default on other platforms. Strangely, they call it advanced security, which is standard on other major operating systems. But this isn't done by defauft. The developer has to take this into account by using the socket option SO_EXCLUSIVEADDRUSE. This has be done.</p>
<p >(Will be continued)</p>
<h1><a class="anchor" id="autotoc_md12"></a>
6. Configure Options for cmake</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option prefixed with -D   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">UPNP_GOOGLETEST=[ON|OFF]   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">Enables installation of GoogleTest for Unit-Tests. For details look at section <em>Googletest build</em>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">BUILD_SHARED_LIBS=[ON|OFF]   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">This option affects only Googletest to build it with shared gtest libraries. UPnPlib is always build shared and static.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMAKE_BUILD_TYPE=[Debug| Release| MinSizeRel| RelWithDebInfo]   </td><td class="markdownTableBodyNone">Release   </td><td class="markdownTableBodyNone">If you set this option to <b>Debug</b> you will have additional developement support. The mnemonic program symbols are compiled into the binary programs so you can better examine the code and simply debug it. But I think it is better to write a Unit Test instead of using a debugger. Compiling with symbols increases the program size a big amount. With focus on embedded devices this is a bad idea.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PT4W_BUILD_TESTING=[ON|OFF]   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">Runs the testsuite of pthreads4w (PT4W) with nearly 1000 tests. It will take some time but should be done at least one time.   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md13"></a>
7. Limitations</h1>
<p >No limits documented so far.</p>
<pre><sup>
Copyright (C) 2021+ GPL 3 and higher by Ingo Höft, &lt;<a href="#" onclick="location.href='mai'+'lto:'+'Ing'+'o@'+'Hoe'+'ft'+'-on'+'li'+'ne.'+'de'; return false;">Ingo@<span class="obfuscator">.nosp@m.</span>Hoef<span class="obfuscator">.nosp@m.</span>t-onl<span class="obfuscator">.nosp@m.</span>ine.<span class="obfuscator">.nosp@m.</span>de</a>&gt;
Redistribution only with this Copyright remark. Last modified: 2024-01-19
</sup></pre> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
